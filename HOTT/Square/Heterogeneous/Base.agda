module HOTT.Square.Heterogeneous.Base where

open import HOTT.Base
open import HOTT.Id
open import HOTT.Exonat
open import HOTT.Cube
open import HOTT.Universe.Parametric
open import HOTT.Functoriality
open import HOTT.Square.Simple
open import HOTT.IdCube
open import HOTT.Corr

----------------------------------------
-- Heterogeneous squares
----------------------------------------

record ‚àÇ2 ∞ {A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ : Type} (A : ‚àÇ2 Type A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ) (A‚ÇÇ‚ÇÇ : Sq Type A)
  (a‚ÇÄ‚ÇÄ : A‚ÇÄ‚ÇÄ) (a‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ) (a‚ÇÅ‚ÇÄ : A‚ÇÅ‚ÇÄ) (a‚ÇÅ‚ÇÅ : A‚ÇÅ‚ÇÅ) : Type·µâ where
  constructor ‚îè‚îÅ_‚îÅ‚îì_‚ñ°_‚îó‚îÅ_‚îÅ‚îõ
  infix 70 _‚ÇÅ‚ÇÇ _‚ÇÇ‚ÇÄ _‚ÇÇ‚ÇÅ _‚ÇÄ‚ÇÇ
  field
    _‚ÇÅ‚ÇÇ : ‚ü¶ A ‚ÇÅ‚ÇÇ ‚üß ‚àô a‚ÇÅ‚ÇÄ ‚àô a‚ÇÅ‚ÇÅ
    _‚ÇÇ‚ÇÄ : ‚ü¶ A ‚ÇÇ‚ÇÄ ‚üß ‚àô a‚ÇÄ‚ÇÄ ‚àô a‚ÇÅ‚ÇÄ
    _‚ÇÇ‚ÇÅ : ‚ü¶ A ‚ÇÇ‚ÇÅ ‚üß ‚àô a‚ÇÄ‚ÇÅ ‚àô a‚ÇÅ‚ÇÅ
    _‚ÇÄ‚ÇÇ : ‚ü¶ A ‚ÇÄ‚ÇÇ ‚üß ‚àô a‚ÇÄ‚ÇÄ ‚àô a‚ÇÄ‚ÇÅ
open ‚àÇ2 ∞ public

sym-‚àÇ2 ∞ : {A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ : Type} {A : ‚àÇ2 Type A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ} {A‚ÇÇ‚ÇÇ : Sq Type A}
  {a‚ÇÄ‚ÇÄ : A‚ÇÄ‚ÇÄ} {a‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ} {a‚ÇÅ‚ÇÄ : A‚ÇÅ‚ÇÄ} {a‚ÇÅ‚ÇÅ : A‚ÇÅ‚ÇÅ} ‚Üí
  ‚àÇ2 ∞ A A‚ÇÇ‚ÇÇ a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ ‚Üí ‚àÇ2 ∞ (sym-‚àÇ2 A) (sym Type A A‚ÇÇ‚ÇÇ) a‚ÇÄ‚ÇÄ a‚ÇÅ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÅ
sym-‚àÇ2 ∞ a = ‚îè‚îÅ   a ‚ÇÇ‚ÇÅ   ‚îÅ‚îì
            a ‚ÇÄ‚ÇÇ  ‚ñ°   a ‚ÇÅ‚ÇÇ
            ‚îó‚îÅ   a ‚ÇÇ‚ÇÄ   ‚îÅ‚îõ

‚àÇ2 ∞-refl-refl : {A : Type} {a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ : A} ‚Üí
  ‚àÇ2 ∞ (refl-‚àÇ2 A) (refl (refl A)) a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ ‚Üí ‚àÇ2 A a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ
‚àÇ2 ∞-refl-refl ‚îè‚îÅ a‚ÇÅ‚ÇÇ ‚îÅ‚îì
              a‚ÇÇ‚ÇÄ ‚ñ° a‚ÇÇ‚ÇÅ
              ‚îó‚îÅ a‚ÇÄ‚ÇÇ ‚îÅ‚îõ = ‚îå‚îÄ  a‚ÇÅ‚ÇÇ  ‚îÄ‚îê
                           a‚ÇÇ‚ÇÄ  ‚ñ°  a‚ÇÇ‚ÇÅ
                           ‚îî‚îÄ  a‚ÇÄ‚ÇÇ  ‚îÄ‚îò

Sq ∞ : {A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ : Type} (A : ‚àÇ2 Type A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ) (A‚ÇÇ‚ÇÇ : Sq Type A)
  {a‚ÇÄ‚ÇÄ : A‚ÇÄ‚ÇÄ} {a‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ} {a‚ÇÅ‚ÇÄ : A‚ÇÅ‚ÇÄ} {a‚ÇÅ‚ÇÅ : A‚ÇÅ‚ÇÅ} (a : ‚àÇ2 ∞ A A‚ÇÇ‚ÇÇ a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ) ‚Üí Type
Sq ∞ {A‚ÇÄ‚ÇÄ} {A‚ÇÄ‚ÇÅ} {A‚ÇÅ‚ÇÄ} {A‚ÇÅ‚ÇÅ} A A‚ÇÇ‚ÇÇ {a‚ÇÄ‚ÇÄ} {a‚ÇÄ‚ÇÅ} {a‚ÇÅ‚ÇÄ} {a‚ÇÅ‚ÇÅ} a =
  ‚ü¶ _‚àô_ {Ôºà x‚ÇÄ ‚¶Ç A‚ÇÅ‚ÇÄ Ôºâ√ó Ôºà x‚ÇÅ ‚¶Ç A‚ÇÅ‚ÇÅ Ôºâ√ó ‚ü¶ A ‚ÇÅ‚ÇÇ ‚üß ‚àô x‚ÇÄ ‚àô x‚ÇÅ}
    (_‚àô_ {Ôºà x‚ÇÄ ‚¶Ç A‚ÇÄ‚ÇÄ Ôºâ√ó Ôºà x‚ÇÅ ‚¶Ç A‚ÇÄ‚ÇÅ Ôºâ√ó ‚ü¶ A ‚ÇÄ‚ÇÇ ‚üß ‚àô x‚ÇÄ ‚àô x‚ÇÅ}
      (snd (fst (corr {ùê¨ (ùê¨ ùê≥)} (((‚òÖ , ‚òÖ , ‚òÖ , A‚ÇÄ‚ÇÄ , A‚ÇÅ‚ÇÄ) , (‚òÖ , ‚òÖ , ‚òÖ , A‚ÇÄ‚ÇÅ , A‚ÇÅ‚ÇÅ) , (‚òÖ , ‚òÖ , ‚òÖ , A ‚ÇÄ‚ÇÇ , A ‚ÇÅ‚ÇÇ) , A ‚ÇÇ‚ÇÄ , A ‚ÇÇ‚ÇÅ) , A‚ÇÇ‚ÇÇ))))
     -- I don't know why the families aren't inferred here.
       (a‚ÇÄ‚ÇÄ , a‚ÇÄ‚ÇÅ , a ‚ÇÄ‚ÇÇ))
    (a‚ÇÅ‚ÇÄ , a‚ÇÅ‚ÇÅ , a ‚ÇÅ‚ÇÇ) ‚üß ‚àô (a ‚ÇÇ‚ÇÄ) ‚àô (a ‚ÇÇ‚ÇÅ)

-- The other component of corr is a primitive symmetrized square.  The
-- two are interchanged by symmetry acting on U, and are isomorphic to
-- each other by a postulated heterogeneous symmetry.
Sym ∞ : {A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ : Type} (A : ‚àÇ2 Type A‚ÇÄ‚ÇÄ A‚ÇÄ‚ÇÅ A‚ÇÅ‚ÇÄ A‚ÇÅ‚ÇÅ) (A‚ÇÇ‚ÇÇ : Sq Type A)
  {a‚ÇÄ‚ÇÄ : A‚ÇÄ‚ÇÄ} {a‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ} {a‚ÇÅ‚ÇÄ : A‚ÇÅ‚ÇÄ} {a‚ÇÅ‚ÇÅ : A‚ÇÅ‚ÇÅ} (a : ‚àÇ2 ∞ A A‚ÇÇ‚ÇÇ a‚ÇÄ‚ÇÄ a‚ÇÄ‚ÇÅ a‚ÇÅ‚ÇÄ a‚ÇÅ‚ÇÅ) ‚Üí Type
Sym ∞ {A‚ÇÄ‚ÇÄ} {A‚ÇÄ‚ÇÅ} {A‚ÇÅ‚ÇÄ} {A‚ÇÅ‚ÇÅ} A A‚ÇÇ‚ÇÇ {a‚ÇÄ‚ÇÄ} {a‚ÇÄ‚ÇÅ} {a‚ÇÅ‚ÇÄ} {a‚ÇÅ‚ÇÅ} a =
  ‚ü¶ _‚àô_ {Ôºà x‚ÇÄ ‚¶Ç A‚ÇÄ‚ÇÅ Ôºâ√ó Ôºà x‚ÇÅ ‚¶Ç A‚ÇÅ‚ÇÅ Ôºâ√ó ‚ü¶ A ‚ÇÇ‚ÇÅ ‚üß ‚àô x‚ÇÄ ‚àô x‚ÇÅ}
    (_‚àô_ {Ôºà x‚ÇÄ ‚¶Ç A‚ÇÄ‚ÇÄ Ôºâ√ó Ôºà x‚ÇÅ ‚¶Ç A‚ÇÅ‚ÇÄ Ôºâ√ó ‚ü¶ A ‚ÇÇ‚ÇÄ ‚üß ‚àô x‚ÇÄ ‚àô x‚ÇÅ}
      (snd (corr {ùê¨ (ùê¨ ùê≥)} (((‚òÖ , ‚òÖ , ‚òÖ , A‚ÇÄ‚ÇÄ , A‚ÇÅ‚ÇÄ) , (‚òÖ , ‚òÖ , ‚òÖ , A‚ÇÄ‚ÇÅ , A‚ÇÅ‚ÇÅ) , (‚òÖ , ‚òÖ , ‚òÖ , A ‚ÇÄ‚ÇÇ , A ‚ÇÅ‚ÇÇ) , A ‚ÇÇ‚ÇÄ , A ‚ÇÇ‚ÇÅ) , A‚ÇÇ‚ÇÇ)))
      (a‚ÇÄ‚ÇÄ , a‚ÇÅ‚ÇÄ , a ‚ÇÇ‚ÇÄ))
    (a‚ÇÄ‚ÇÅ , a‚ÇÅ‚ÇÅ , a ‚ÇÇ‚ÇÅ) ‚üß ‚àô (a ‚ÇÄ‚ÇÇ) ‚àô (a ‚ÇÅ‚ÇÇ)
